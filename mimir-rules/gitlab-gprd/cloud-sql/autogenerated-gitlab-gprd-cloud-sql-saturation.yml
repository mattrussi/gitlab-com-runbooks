# WARNING. DO NOT EDIT THIS FILE BY HAND. USE ./mimir-rules-jsonnet/saturation.jsonnet TO GENERATE IT
# YOUR CHANGES WILL BE OVERRIDDEN
groups:
- name: Saturation Rules (autogenerated)
  interval: 1m
  rules:
  - record: gitlab_component_saturation:ratio
    labels:
      component: cloudsql_cpu
      stage: main
      tier: inf
      type: monitoring
    expr: |
      max by(env, environment, shard, database_id) (
        clamp_min(
          clamp_max(
            avg_over_time(stackdriver_cloudsql_database_cloudsql_googleapis_com_database_cpu_utilization{env="gprd",type="cloud-sql"}[5m])
            ,
            1)
        ,
        0)
      )
  - record: gitlab_component_saturation:ratio
    labels:
      component: cloudsql_disk
      stage: main
      tier: inf
      type: monitoring
    expr: |
      max by(env, environment, shard, database_id) (
        clamp_min(
          clamp_max(
            avg_over_time(stackdriver_cloudsql_database_cloudsql_googleapis_com_database_disk_utilization{env="gprd",type="cloud-sql"}[5m])
            ,
            1)
        ,
        0)
      )
  - record: gitlab_component_saturation:ratio
    labels:
      component: cloudsql_memory
      stage: main
      tier: inf
      type: monitoring
    expr: |
      max by(env, environment, shard, database_id) (
        clamp_min(
          clamp_max(
            avg_over_time(stackdriver_cloudsql_database_cloudsql_googleapis_com_database_memory_utilization{env="gprd",type="cloud-sql"}[5m])
            ,
            1)
        ,
        0)
      )
