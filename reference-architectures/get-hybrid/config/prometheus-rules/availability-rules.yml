# WARNING. DO NOT EDIT THIS FILE BY HAND. RUN ./scripts/generate-all-reference-architecture-configs.sh TO GENERATE IT. YOUR CHANGES WILL BE OVERRIDDEN
groups:
- interval: 5m
  name: Autogenerated Availability Rates
  rules:
  - expr: |
      sum by (type) (
        (
          sum by(type) (
            gitlab_service_ops:rate_1h{type=~"registry|webservice"}
          )
          +
          sum by (type) (
            gitlab_service_apdex:weight:score_1h{type=~"registry|webservice"}
          )
        )
      )
    record: gitlab:availability:ops:rate_1h
  - expr: |
      sum by (type) (
        (
          sum by(type) (
            gitlab_service_apdex:success:rate_1h{type=~"registry|webservice"}
          )
          +
          sum by (type)(
            gitlab_service_ops:rate_1h{type=~"registry|webservice"} - gitlab_service_errors:rate_1h{type=~"registry|webservice"}
          )
        )
      )
    record: gitlab:availability:success:rate_1h
