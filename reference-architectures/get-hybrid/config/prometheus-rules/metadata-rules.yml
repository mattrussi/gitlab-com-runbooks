# WARNING. DO NOT EDIT THIS FILE BY HAND. RUN ./scripts/generate-all-reference-architecture-configs.sh TO GENERATE IT. YOUR CHANGES WILL BE OVERRIDDEN
groups:
- interval: 5m
  name: GitLab Component Saturation Max SLOs
  rules:
  - expr: "0.8"
    labels:
      component: cpu
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: cpu
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.75"
    labels:
      component: disk_inodes
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.8"
    labels:
      component: disk_inodes
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.85"
    labels:
      component: disk_space
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: disk_space
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: go_goroutines
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.98"
    labels:
      component: go_goroutines
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: go_memory
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.98"
    labels:
      component: go_memory
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: kube_container_cpu_limit
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.99"
    labels:
      component: kube_container_cpu_limit
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.8"
    labels:
      component: kube_container_memory
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: kube_container_memory
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.8"
    labels:
      component: kube_container_rss
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: kube_container_rss
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.85"
    labels:
      component: kube_persistent_volume_claim_disk_space
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: kube_persistent_volume_claim_disk_space
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.85"
    labels:
      component: kube_persistent_volume_claim_inodes
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: kube_persistent_volume_claim_inodes
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: memory
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.98"
    labels:
      component: memory
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.8"
    labels:
      component: node_group_cpu
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: node_group_cpu
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.1"
    labels:
      component: node_schedstat_waiting
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.15"
    labels:
      component: node_schedstat_waiting
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.85"
    labels:
      component: puma_workers
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: puma_workers
    record: slo:max:hard:gitlab_component_saturation:ratio
  - expr: "0.9"
    labels:
      component: single_node_cpu
    record: slo:max:soft:gitlab_component_saturation:ratio
  - expr: "0.95"
    labels:
      component: single_node_cpu
    record: slo:max:hard:gitlab_component_saturation:ratio
- interval: 5m
  name: GitLab Component Saturation Metadata
  rules:
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: cpu
      horiz_scaling: "yes"
      quantile: max
      severity: s3
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: disk_inodes
      horiz_scaling: "yes"
      quantile: max
      severity: s2
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: disk_space
      horiz_scaling: "yes"
      quantile: max
      severity: s2
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: go_goroutines
      horiz_scaling: "yes"
      quantile: max
      severity: s2
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: go_memory
      horiz_scaling: "yes"
      quantile: max
      severity: s4
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: exclude
      component: kube_container_cpu_limit
      horiz_scaling: "yes"
      quantile: max
      severity: s4
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: kube_container_memory
      horiz_scaling: "yes"
      quantile: max
      severity: s4
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: kube_container_rss
      horiz_scaling: "yes"
      quantile: max
      severity: s4
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: kube_persistent_volume_claim_disk_space
      horiz_scaling: "yes"
      quantile: max
      severity: s2
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: kube_persistent_volume_claim_inodes
      horiz_scaling: "yes"
      quantile: max
      severity: s2
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: memory
      horiz_scaling: "yes"
      quantile: max
      severity: s4
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: node_group_cpu
      horiz_scaling: "yes"
      quantile: max
      severity: s3
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: exclude
      component: node_schedstat_waiting
      horiz_scaling: "yes"
      quantile: max
      severity: s4
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: quantile95_1h
      component: puma_workers
      horiz_scaling: "yes"
      quantile: max
      severity: s2
    record: gitlab_component_saturation_info
  - expr: "1"
    labels:
      capacity_planning_strategy: exclude
      component: single_node_cpu
      horiz_scaling: "yes"
      quantile: max
      severity: s4
    record: gitlab_component_saturation_info
